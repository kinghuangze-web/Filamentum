# ğŸ“˜ 3D åˆ›ä½œå·¥åŠ - é¡¹ç›®å¼€å‘æ‰‹å†Œ

> **é¡¹ç›®åç§°**: FilamentFlow (3D æ‰“å°è€—æç®¡ç†ç³»ç»Ÿ)  
> **æŠ€æœ¯æ ˆ**: Next.js 15 + React 19 + TypeScript + Tailwind CSS 4  
> **å¼€å‘å‘¨æœŸ**: 2026å¹´1æœˆ  
> **æ–‡æ¡£ç‰ˆæœ¬**: v1.0

---

## ğŸ“š ç›®å½•

1. [é¡¹ç›®æ¦‚è¿°](#é¡¹ç›®æ¦‚è¿°)
2. [æ¶æ„è®¾è®¡](#æ¶æ„è®¾è®¡)
3. [å¼€å‘é˜¶æ®µæ€»è§ˆ](#å¼€å‘é˜¶æ®µæ€»è§ˆ)
4. [åŠŸèƒ½æ¨¡å—è¯´æ˜](#åŠŸèƒ½æ¨¡å—è¯´æ˜)
5. [æŠ€æœ¯è§„èŒƒ](#æŠ€æœ¯è§„èŒƒ)
6. [ä¼˜åŒ–è®°å½•](#ä¼˜åŒ–è®°å½•)
7. [åç»­è§„åˆ’](#åç»­è§„åˆ’)

---

## é¡¹ç›®æ¦‚è¿°

### æ ¸å¿ƒåŠŸèƒ½

| æ¨¡å— | åŠŸèƒ½ | çŠ¶æ€ |
|------|------|------|
| è€—æç®¡ç† | CRUDã€æœç´¢ç­›é€‰ã€åº“å­˜è¿½è¸ª | âœ… å®Œæˆ |
| æ‰“å°ä»»åŠ¡ | å¤šè‰²æ‰“å°ã€åº“å­˜æ‰£å‡ã€å†å²è®°å½• | âœ… å®Œæˆ |
| é¢„è®¾ç®¡ç† | æ¨¡æ¿å¯¼å…¥ã€.bbsflmt æ ¼å¼æ”¯æŒ | âœ… å®Œæˆ |
| AI ä¸­å¿ƒ | æˆªå›¾è§£æã€å¯¹è¯åŠ©æ‰‹ã€è§†è§‰è¯†åˆ« | âœ… å®Œæˆ |
| å†œåœºæ¨¡å¼ | å¤šè®¾å¤‡ä»ªè¡¨ç›˜ (åŸºç¡€ç‰ˆ) | âš ï¸ è¿›è¡Œä¸­ |
| æˆæœ¬è®¡ç®— | ç”µè´¹/äººå·¥/æŠ˜æ—§ | âœ… å®Œæˆ |

### é¡¹ç›®ç»“æ„

```
my-3d-app/
â”œâ”€â”€ app/                          # Next.js App Router
â”‚   â”œâ”€â”€ api/                      # API Routes
â”‚   â”‚   â”œâ”€â”€ storage/              # æœ¬åœ° JSON å­˜å‚¨
â”‚   â”‚   â””â”€â”€ presets/              # é¢„è®¾ç®¡ç†
â”‚   â”œâ”€â”€ page.tsx                  # ä¸»é¡µé¢ (374 è¡Œ)
â”‚   â”œâ”€â”€ layout.tsx                # å…¨å±€å¸ƒå±€ + Toaster
â”‚   â””â”€â”€ globals.css               # è®¾è®¡ç³»ç»Ÿ (CSS å˜é‡)
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ components/               # UI ç»„ä»¶ (18 ä¸ª)
â”‚   â”‚   â”œâ”€â”€ AppHeader.tsx         # é¡¶æ  (React.memo)
â”‚   â”‚   â”œâ”€â”€ FilamentTable.tsx     # è€—æå¡ç‰‡ç½‘æ ¼
â”‚   â”‚   â”œâ”€â”€ FilamentDetailModal.tsx
â”‚   â”‚   â”œâ”€â”€ AddEditFilamentModal.tsx
â”‚   â”‚   â”œâ”€â”€ PrintJobModal.tsx
â”‚   â”‚   â”œâ”€â”€ WorksGallery.tsx      # ä½œå“é›†ç”»å»Š
â”‚   â”‚   â”œâ”€â”€ AIHubModal.tsx        # AI å‘½ä»¤ä¸­å¿ƒ
â”‚   â”‚   â”œâ”€â”€ SettingsModal.tsx     # è®¾ç½® (æ‰“å°æœº/æˆæœ¬)
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”œâ”€â”€ lib/                      # å·¥å…·åº“
â”‚   â”‚   â”œâ”€â”€ types.ts              # TypeScript ç±»å‹
â”‚   â”‚   â”œâ”€â”€ constants.ts          # å…¬å…±å¸¸é‡
â”‚   â”‚   â”œâ”€â”€ ai-service.ts         # AI æœåŠ¡å°è£…
â”‚   â”‚   â””â”€â”€ crypto.ts             # AES åŠ å¯†
â”‚   â””â”€â”€ services/                 # æœåŠ¡å±‚
â”‚       â”œâ”€â”€ filament-service.ts   # è€—æ CRUD
â”‚       â””â”€â”€ preset-service.ts     # é¢„è®¾ç®¡ç†
â””â”€â”€ data/                         # æŒä¹…åŒ–æ•°æ®
    â”œâ”€â”€ filaments.json
    â”œâ”€â”€ presets/
    â””â”€â”€ backups/                  # æ¯æ—¥å¤‡ä»½
```

---

## æ¶æ„è®¾è®¡

### åˆ†å±‚æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   UI ç»„ä»¶å±‚                          â”‚
â”‚  (FilamentTable, AIHubModal, SettingsModal, ...)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    çŠ¶æ€ç®¡ç†å±‚                        â”‚
â”‚  (page.tsx: useState, useEffect, Modals çŠ¶æ€)       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    æœåŠ¡å±‚ (Services)                 â”‚
â”‚  filamentService.getAll() / save() / delete()      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    API å±‚ (Routes)                   â”‚
â”‚  /api/storage (JSON è¯»å†™)                           â”‚
â”‚  /api/presets (é¢„è®¾ç®¡ç†)                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    æŒä¹…åŒ–å±‚ (Data)                   â”‚
â”‚  data/filaments.json + data/backups/                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ‰©å±•æ€§è®¾è®¡

**æœåŠ¡å±‚æ¨¡å¼ (Service Layer Pattern)**ï¼šUI ç»„ä»¶ä¸ç›´æ¥æ“ä½œæ•°æ®æºï¼Œè€Œæ˜¯é€šè¿‡æœåŠ¡å±‚ã€‚æœªæ¥æ¥å…¥åç«¯æ—¶ï¼Œåªéœ€æ›¿æ¢æœåŠ¡å±‚å®ç°ï¼Œç»„ä»¶ä»£ç æ— éœ€ä¿®æ”¹ã€‚

---

## å¼€å‘é˜¶æ®µæ€»è§ˆ

### P0: åŸºç¡€æ¶æ„ âœ…
- åˆ›å»º `constants.ts` ç»Ÿä¸€å…¬å…±å¸¸é‡
- æ•°å­—è¾“å…¥èŒƒå›´æ ¡éªŒ
- 5 ä¸ªç»„ä»¶ä½¿ç”¨ç»Ÿä¸€å¸¸é‡

### P1: äº¤äº’ä¼˜åŒ– âœ…
- å›¾ç‰‡ä¸Šä¼ å‹ç¼©
- FilamentCard / SpoolRing ä½¿ç”¨ `React.memo`
- ä½œå“é›†ç”»å»Šè§†å›¾ (WorksGallery)

### P2: åç«¯é€‚é… âœ…
- åˆ›å»º Service å±‚æ¨¡æ‹Ÿå¼‚æ­¥æ¥å£
- æ”¹é€  page.tsx ä½¿ç”¨ Service
- Loading çŠ¶æ€å’Œé”™è¯¯å¤„ç†

### P3: æ•°æ®å®‰å…¨ âœ…
- API Route è¯»å†™æœ¬åœ° JSON
- æ¯æ—¥è‡ªåŠ¨å¤‡ä»½ `data/backups/`
- æ•°æ®æŒä¹…åŒ–éªŒè¯

### P4: é¢„è®¾ç®¡ç† âœ…
- `.bbsflmt` æ ¼å¼æ”¯æŒ
- é¢„è®¾ç®¡ç† UI (å¯¼å…¥/æ–°å»º/ç¼–è¾‘)
- è®¾ç½®ä¸­æ·»åŠ å…¥å£

### P5-P6: UX ä¼˜åŒ– âœ…
- ä½œå“é›†ç›´æ¥å¢åˆ æ”¹
- è€—æå¡ç‰‡"æŸ¥çœ‹ä½œå“"å¿«æ·å…¥å£
- åˆ é™¤/ä¿®æ”¹ä½œå“åŒæ­¥æ›´æ–°æ•°æ®

### P7: å®‰å…¨ä¸ AI âœ…
- å‰ç«¯ AES åŠ å¯†å·¥å…·
- BYOK è®¾ç½®é¢æ¿ (è®¾ç½®å¯†ç /ç®¡ç†å¯†é’¥)
- æ¥å…¥é€šç”¨ OpenAI æ¥å£ (æ”¯æŒ Qwen/DeepSeek)

### P8: AI ä¸­å¿ƒ âœ…
- AI Command Center (æ‚¬æµ®çƒ/é¢æ¿)
- æ‰“å°æœºç®¡ç† (Fleet Management)
- çœŸå®æˆæœ¬è®¡ç®— (ç”µè´¹/äººå·¥/æŠ˜æ—§)

### P9: å†œåœºæ¨¡å¼ âš ï¸
- çŠ¶æ€ç®¡ç†æ·»åŠ  `farmMode` å¼€å…³
- Header æ‰“å°æœºå›¾æ ‡åˆ‡æ¢äº¤äº’
- å†œåœºä»ªè¡¨ç›˜ (ç®€å•ç‰ˆ)

### P10: æˆæœ¬è®¡ç®—å™¨ âœ…
- PrintHistory å¢åŠ  printTime
- æœºå™¨æŠ˜æ—§ç‡è®¾ç½®
- ä½œå“å½•å…¥æ”¯æŒæ‰“å°æ—¶é•¿

### P12: ä»£ç è´¨é‡ä¼˜åŒ– âœ…
- AppHeader ç»„ä»¶æ‹†åˆ† (page.tsx ç²¾ç®€ 90 è¡Œ)
- 5 ç»„ä»¶å›¾ç‰‡ä¼˜åŒ– (next/image)
- sonner Toast é€šçŸ¥ç³»ç»Ÿ
- CSS å˜é‡è¯­ä¹‰åŒ– (å“ç‰Œè‰²/åŠŸèƒ½è‰²)
- ç§»åŠ¨ç«¯å“åº”å¼å¸ƒå±€

---

## åŠŸèƒ½æ¨¡å—è¯´æ˜

### 1. è€—æç®¡ç†

| åŠŸèƒ½ | å…¥å£ | è¯´æ˜ |
|------|------|------|
| æ–°å¢ | Headerã€Œå…¥åº“æ–°ææ–™ã€ | æ”¯æŒé¢„è®¾æ¨¡æ¿ã€Bambu Studio å¯¼å…¥ |
| ç¼–è¾‘ | å¡ç‰‡æ‚¬æµ®ã€Œç¼–è¾‘ã€æŒ‰é’® | å¤ç”¨æ–°å¢è¡¨å• |
| åˆ é™¤ | å¡ç‰‡æ‚¬æµ®ã€Œåˆ é™¤ã€æŒ‰é’® | éœ€ç¡®è®¤å¯¹è¯æ¡† |
| è¯¦æƒ… | ç‚¹å‡»å¡ç‰‡ | æŸ¥çœ‹å‚æ•°ã€å†å²è®°å½• |
| ç­›é€‰ | æœç´¢æ¡† + å“ç‰Œæ ‡ç­¾ | å®æ—¶è¿‡æ»¤ |

### 2. æ‰“å°ä»»åŠ¡

| åŠŸèƒ½ | å…¥å£ | è¯´æ˜ |
|------|------|------|
| è®°å½•ä»»åŠ¡ | Headerã€Œè®°ä¸€ç¬”ã€æˆ–è¯¦æƒ…é¡µ | æ”¯æŒå¤šè‰²æ‰“å° |
| å†å²è®°å½• | è€—æè¯¦æƒ…é¡µ | åŒ…å«ä½œå“å›¾ç‰‡ã€æ¶ˆè€—ã€è¯„åˆ† |
| åˆ é™¤å†å² | å†å²å¡ç‰‡ã€Œåˆ é™¤ã€ | è‡ªåŠ¨å›æ»šåº“å­˜ |
| AI è§£æ | å†å²å½•å…¥æ¡† Sparkles å›¾æ ‡ | æˆªå›¾è¯†åˆ«æ—¶é—´/é‡é‡ |

### 3. AI åŠŸèƒ½

| åŠŸèƒ½ | å…¥å£ | è¯´æ˜ |
|------|------|------|
| è´­ç‰©æˆªå›¾è§£æ | AI ä¸­å¿ƒã€Œå¿«é€Ÿè§£æã€ | æ‰¹é‡å¯¼å…¥è€—æä¿¡æ¯ |
| å¯¹è¯åŠ©æ‰‹ | AI ä¸­å¿ƒã€ŒåŠ©æ‰‹ã€Tab | é€šç”¨é—®ç­” |
| è§†è§‰è¯†åˆ« | AI ä¸­å¿ƒã€Œè§†è§‰ã€Tab | ä¸Šä¼ å›¾ç‰‡åˆ†æ |
| é…ç½®ç®¡ç† | AI ä¸­å¿ƒã€Œè®¾ç½®ã€Tab | BYOKã€å¤šæ¨¡å‹æ”¯æŒ |

---

## æŠ€æœ¯è§„èŒƒ

### ç±»å‹å®šä¹‰ (æ ¸å¿ƒ)

```typescript
// src/lib/types.ts
interface Filament {
  id: string;
  brand: string;
  type: string;
  color: string;
  colorHex: string;
  total: number;
  remaining: number;
  price: number;
  nozzleTemp: string;
  bedSettings: Record<PlateType, { initial: number; other: number }>;
  defaultPlate: PlateType;
  flowRatio: number;
  pressureAdvance: number;
  history: PrintHistory[];
  createdAt: string;
  updatedAt: string;
}

interface PrintHistory {
  id: string;
  name: string;
  weight: number;
  link?: string;
  image?: string;
  date: string;
  printTime?: number;
  rating?: number;
}

interface AIConfig {
  models: ModelConfig[];
  activeModelId: string | null;
  encryptedKeys?: string;
}
```

### CSS è®¾è®¡ç³»ç»Ÿ

```css
/* globals.css - å“ç‰Œè‰² */
:root {
  --brand-primary: oklch(0.769 0.188 70.08);   /* amber-500 */
  --brand-secondary: oklch(0.705 0.213 47.604); /* orange-500 */
  --brand-accent: oklch(0.585 0.233 277.117);   /* violet-500 */
  
  --success: oklch(0.696 0.17 162.48);
  --warning: oklch(0.828 0.189 84.429);
  --info: oklch(0.585 0.233 277.117);
  
  --surface-elevated: oklch(0.985 0 0);
  --surface-sunken: oklch(0.97 0 0);
}
```

### ä»£ç è§„èŒƒ

| è§„èŒƒ | è¦æ±‚ |
|------|------|
| ç»„ä»¶æ€§èƒ½ | é¢‘ç¹æ¸²æŸ“çš„ç»„ä»¶ä½¿ç”¨ `React.memo` |
| å›¾ç‰‡ä¼˜åŒ– | ä½¿ç”¨ `next/image` ä»£æ›¿ `<img>` |
| é€šçŸ¥æç¤º | ä½¿ç”¨ `sonner` Toast ä»£æ›¿ `alert()` |
| å“åº”å¼ | ç§»åŠ¨ç«¯ä¼˜å…ˆï¼š`grid-cols-1 md:grid-cols-3` |
| è¯­è¨€ | UI æ–‡æ¡ˆå’Œä»£ç æ³¨é‡Šä½¿ç”¨ä¸­æ–‡ |

---

## ä¼˜åŒ–è®°å½•

### P12 ä¼˜åŒ–æ€»è§ˆ

| ä¼˜åŒ–é¡¹ | æ”¹åŠ¨ | æ•ˆæœ |
|--------|------|------|
| ä»£ç æ‹†åˆ† | æå– `AppHeader.tsx` | page.tsx 463â†’374 è¡Œ |
| å›¾ç‰‡ä¼˜åŒ– | 5 ç»„ä»¶æ›¿æ¢ä¸º `next/image` | è‡ªåŠ¨æ‡’åŠ è½½ |
| Toast | å®‰è£… `sonner` | éé˜»å¡é€šçŸ¥ |
| Loading | å…¨å±é®ç½©â†’å³ä¸‹è§’é€šçŸ¥ | ä¸é˜»å¡äº¤äº’ |
| å“åº”å¼ | `grid-cols-3`â†’`grid-cols-1 md:grid-cols-3` | ç§»åŠ¨ç«¯å‹å¥½ |
| CSS å˜é‡ | æ·»åŠ å“ç‰Œè‰²/åŠŸèƒ½è‰² | Dark Mode å‡†å¤‡ |
| SEO | ä¸­æ–‡æ ‡é¢˜/æè¿°/lang="zh-CN" | æœ¬åœ°åŒ– |

### æ„å»ºéªŒè¯

| æŒ‡æ ‡ | ç»“æœ |
|------|------|
| TypeScript | âœ… é€šè¿‡ (2.3s) |
| Next.js æ„å»º | âœ… é€šè¿‡ |
| é™æ€é¡µé¢ | âœ… 7/7 |

---

## åç»­è§„åˆ’

### æœªå®Œæˆä»»åŠ¡

- [ ] 12.1.2-12.1.4 ç»§ç»­æ‹†åˆ† page.tsx (DashboardClient + Context)
- [ ] 12.3.2 å®ç°ä¹è§‚æ›´æ–° (Optimistic UI)
- [ ] 12.4.2-12.4.3 å…¶ä»–ç§»åŠ¨ç«¯å¸ƒå±€æ£€æŸ¥
- [ ] 12.5.2 æ›¿æ¢ç¡¬ç¼–ç é¢œè‰²ä¸ºè¯­ä¹‰å˜é‡
- [ ] P9.4-P9.5 å†œåœºæ¨¡å¼ä¿®å¤

### æŠ€æœ¯å€ºåŠ¡

| é¡¹ç›® | ä¼˜å…ˆçº§ | è¯´æ˜ |
|------|--------|------|
| page.tsx çŠ¶æ€ç®¡ç† | P2 | è€ƒè™‘ä½¿ç”¨ Zustand/Context |
| æœç´¢ç­›é€‰é€»è¾‘ | P2 | UI å·²æœ‰ï¼Œé€»è¾‘å¾…æ¥å…¥ |
| Dark Mode | P3 | CSS å˜é‡å·²å‡†å¤‡ |
| åç«¯æ¥å…¥ | P4 | æœåŠ¡å±‚å·²è®¾è®¡å¥½æ¥å£ |

---

## ğŸ“ é™„å½•

### ç›¸å…³æ–‡æ¡£

- æ¶æ„æŒ‡å—: `development_roadmap.md`
- åŠŸèƒ½æ¸…å•: `feature_checklist.md`
- UI è¿ç§»æ¸…å•: `ui_migration_checklist.md`
- ä¼˜åŒ–å®¡è®¡: `optimization_audit.md`

### å¼€å‘å‘½ä»¤

```bash
# å¼€å‘æ¨¡å¼
npm run dev

# æ„å»º
npm run build

# å¯åŠ¨ç”Ÿäº§æœåŠ¡
npm start
```

---

*æ–‡æ¡£ç”Ÿæˆæ—¶é—´: 2026-01-28*  
*By Antigravity AI Assistant*
